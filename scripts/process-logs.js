const fs = require('fs'); const path = require('path'); const LOG_PATH = path.join(process.cwd(), 'data', 'logs.json'); const KB_PATH = path.join(process.cwd(), 'data', 'knowledge.json'); function readJSON(p){ return fs.existsSync(p)? JSON.parse(fs.readFileSync(p,'utf-8')):[] } const logs = readJSON(LOG_PATH); const kb = readJSON(KB_PATH); const counts = {}; logs.forEach(l=>{ const q = (l.question||'').toLowerCase(); if(!q) return; counts[q] = (counts[q]||0)+1 }); const frequent = Object.entries(counts).sort((a,b)=>b[1]-a[1]).slice(0,20); frequent.forEach(([q,c],i)=>{ const item = { id: 'candidate-'+Date.now()+'-'+i, title: 'Candidate: '+q.slice(0,60), source: 'logs', text: 'Autogenerated draft from logs: '+q, createdAt: new Date().toISOString() }; kb.push(item); }); fs.writeFileSync(KB_PATH, JSON.stringify(kb,null,2)); console.log('Added', frequent.length, 'candidate items to knowledge base (for review).');
